<div class="auth-wrapper"> <div class="container">
    
    <div class="form-header">
      <div class="icon-area">
        @if(idEdicao) {
          <i class="ph ph-user-gear"></i> } @else {
          <i class="ph ph-user-plus"></i> }
      </div>
      <div class="header-text">
        <h2>{{ idEdicao ? 'Editar Usuário' : 'Crie sua Conta' }}</h2>
        <p>Preencha seus dados de acesso abaixo.</p>
      </div>
    </div>

    <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" autocomplete="off">
      
      <div class="form-group">
        <label>Nome Completo</label>
        <div class="input-wrapper">
          <i class="ph ph-user"></i>
          <input type="text" formControlName="usuTxNome" placeholder="Seu nome completo">
        </div>
        @if (registerForm.controls.usuTxNome.touched && registerForm.controls.usuTxNome.errors?.['required']) {
          <div class="error-msg">Nome é obrigatório.</div>
        }
      </div>

      <div class="form-group">
        <label>E-mail</label>
        <div class="input-wrapper">
          <i class="ph ph-envelope-simple"></i>
          <input 
            type="email" 
            formControlName="usuTxEmail" 
            placeholder="seu@email.com"
            autocomplete="off"
            [class.error]="registerForm.controls.usuTxEmail.invalid && registerForm.controls.usuTxEmail.touched">
        </div>
        
        @if(registerForm.controls.usuTxEmail.invalid && registerForm.controls.usuTxEmail.touched){
          <div class="error-msg">
            @if (registerForm.controls.usuTxEmail.hasError('required')) { Email é obrigatório. }
            @if (registerForm.controls.usuTxEmail.hasError('email')) { Email inválido. }
          </div>
        }
      </div>

      @if (!idEdicao) {
        <div class="form-group">
            <label>Senha</label>
            <div class="input-wrapper">
            <i class="ph ph-lock-key"></i>
            <input 
                type="password" 
                formControlName="usuTxSenha" 
                placeholder="******"
                autocomplete="new-password"
                [class.error]="registerForm.controls.usuTxSenha.invalid && registerForm.controls.usuTxSenha.touched">
            </div>

            @if(registerForm.controls.usuTxSenha.invalid && registerForm.controls.usuTxSenha.touched){
            <div class="error-msg">
                @if (registerForm.controls.usuTxSenha.hasError('required')) { Senha é obrigatória. }
                @if (registerForm.controls.usuTxSenha.hasError('minlength')) { Mínimo de 6 caracteres. }
            </div>
            }
        </div>
        <div class="form-group">
          <label>Confirmar Senha</label>
          <div class="input-wrapper">
            <i class="ph ph-check-circle"></i>
            <input type="password" formControlName="confirmPassword" placeholder="Repita a senha">
          </div>
          
          @if (registerForm.controls.confirmPassword.touched && registerForm.controls.confirmPassword.hasError('passwordMismatch')) {
            <div class="error-msg">As senhas não coincidem.</div>
          }
        </div>
      }

      <div class="actions">
        @if(idEdicao){
          <button type="button" class="btn-cancelar" (click)="cancelar()">
            Cancelar
          </button>
        }

        <app-btn-primary 
          [label]="idEdicao ? 'Salvar Alterações' : 'Cadastrar'" 
          icon="check" 
          type="submit"
          [disabled]="registerForm.invalid">
        </app-btn-primary>
      </div>

    </form>

    @if (!idEdicao) {
      <div class="footer-link">
        <p>Já tem conta? <a routerLink="/login">Faça Login</a></p>
      </div>
    }

  </div>
</div>